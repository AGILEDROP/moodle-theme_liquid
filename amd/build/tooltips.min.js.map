{"version":3,"file":"tooltips.min.js","sources":["../src/tooltips.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Enhanced tooltip functionality for theme Liquid.\n * - Smart positioning (auto-adjusts based on available space)\n * - Hover-only trigger (no focus or click triggers)\n * - Dark mode support\n *\n * @module     theme_liquid/tooltips\n * @copyright  2025 Agiledrop ltd.\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as Bootstrap from 'theme_boost/index';\n\n/**\n * Initialize all tooltips with enhanced configuration\n */\nconst initializeTooltips = () => {\n    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle=\"tooltip\"]');\n\n    // Enhanced tooltip configuration\n    const tooltipConfig = {\n        placement: 'auto', // Auto-position based on available space\n        trigger: 'hover', // Only hover - no focus or click\n        fallbackPlacements: ['top', 'right', 'bottom', 'left'], // Try all sides\n        boundary: 'viewport', // Use viewport as boundary for positioning\n        popperConfig: {\n            strategy: 'fixed', // Better positioning for fixed/absolute elements\n            modifiers: [\n                {\n                    name: 'flip',\n                    options: {\n                        fallbackPlacements: ['top', 'right', 'bottom', 'left'],\n                        // Allow flipping to any side with space\n                        allowedAutoPlacements: ['top', 'right', 'bottom', 'left'],\n                    }\n                },\n                {\n                    name: 'preventOverflow',\n                    options: {\n                        boundary: 'viewport',\n                        padding: 8,\n                        // Ensure tooltip stays within viewport\n                        altAxis: true,\n                        tether: false,\n                    }\n                }\n            ]\n        }\n    };\n\n    // Store tooltip instances\n    const tooltipInstances = new Map();\n\n    // Initialize tooltips with enhanced config\n    [...tooltipTriggerList].forEach(tooltipTriggerEl => {\n        // Destroy existing tooltip if it exists (to reconfigure)\n        const existingTooltip = Bootstrap.Tooltip.getInstance(tooltipTriggerEl);\n        if (existingTooltip) {\n            existingTooltip.dispose();\n        }\n\n        const tooltip = new Bootstrap.Tooltip(tooltipTriggerEl, tooltipConfig);\n        tooltipInstances.set(tooltipTriggerEl, tooltip);\n    });\n\n    // Hide all tooltips on Escape key\n    document.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape') {\n            tooltipInstances.forEach(tooltip => {\n                tooltip.hide();\n            });\n        }\n    });\n\n    // Handle dynamically added tooltips (for AJAX content)\n    const observer = new MutationObserver((mutations) => {\n        mutations.forEach((mutation) => {\n            mutation.addedNodes.forEach((node) => {\n                if (node.nodeType === 1) { // Element node\n                    const newTooltips = node.querySelectorAll('[data-bs-toggle=\"tooltip\"]');\n                    newTooltips.forEach((tooltipEl) => {\n                        if (!tooltipInstances.has(tooltipEl)) {\n                            const tooltip = new Bootstrap.Tooltip(tooltipEl, tooltipConfig);\n                            tooltipInstances.set(tooltipEl, tooltip);\n                        }\n                    });\n                }\n            });\n        });\n    });\n\n    // Observe the entire document for dynamic content\n    observer.observe(document.body, {\n        childList: true,\n        subtree: true\n    });\n};\n\nexport const init = () => {\n    // Wait for DOM to be ready\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', initializeTooltips);\n    } else {\n        initializeTooltips();\n    }\n};\n"],"names":["initializeTooltips","tooltipTriggerList","document","querySelectorAll","tooltipConfig","placement","trigger","fallbackPlacements","boundary","popperConfig","strategy","modifiers","name","options","allowedAutoPlacements","padding","altAxis","tether","tooltipInstances","Map","forEach","tooltipTriggerEl","existingTooltip","Bootstrap","Tooltip","getInstance","dispose","tooltip","set","addEventListener","e","key","hide","MutationObserver","mutations","mutation","addedNodes","node","nodeType","tooltipEl","has","observe","body","childList","subtree","readyState"],"mappings":";;;;;;;;;;uBA+BMA,mBAAqB,WACjBC,mBAAqBC,SAASC,iBAAiB,8BAG/CC,cAAgB,CAClBC,UAAW,OACXC,QAAS,QACTC,mBAAoB,CAAC,MAAO,QAAS,SAAU,QAC/CC,SAAU,WACVC,aAAc,CACVC,SAAU,QACVC,UAAW,CACP,CACIC,KAAM,OACNC,QAAS,CACLN,mBAAoB,CAAC,MAAO,QAAS,SAAU,QAE/CO,sBAAuB,CAAC,MAAO,QAAS,SAAU,UAG1D,CACIF,KAAM,kBACNC,QAAS,CACLL,SAAU,WACVO,QAAS,EAETC,SAAS,EACTC,QAAQ,OAQtBC,iBAAmB,IAAIC,QAGzBlB,oBAAoBmB,SAAQC,yBAEtBC,gBAAkBC,UAAUC,QAAQC,YAAYJ,kBAClDC,iBACAA,gBAAgBI,gBAGdC,QAAU,IAAIJ,UAAUC,QAAQH,iBAAkBjB,eACxDc,iBAAiBU,IAAIP,iBAAkBM,YAI3CzB,SAAS2B,iBAAiB,WAAYC,IACpB,WAAVA,EAAEC,KACFb,iBAAiBE,SAAQO,UACrBA,QAAQK,aAMH,IAAIC,kBAAkBC,YACnCA,UAAUd,SAASe,WACfA,SAASC,WAAWhB,SAASiB,UACH,IAAlBA,KAAKC,SAAgB,CACDD,KAAKlC,iBAAiB,8BAC9BiB,SAASmB,gBACZrB,iBAAiBsB,IAAID,WAAY,OAC5BZ,QAAU,IAAIJ,UAAUC,QAAQe,UAAWnC,eACjDc,iBAAiBU,IAAIW,UAAWZ,uBAS/Cc,QAAQvC,SAASwC,KAAM,CAC5BC,WAAW,EACXC,SAAS,mBAIG,KAEY,YAAxB1C,SAAS2C,WACT3C,SAAS2B,iBAAiB,mBAAoB7B,oBAE9CA"}